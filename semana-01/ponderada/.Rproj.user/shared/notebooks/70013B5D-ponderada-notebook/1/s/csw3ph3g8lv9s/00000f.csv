"0","create_categorical_correlation_plot <- function(data, table_name) {"
"0","  categorical_vars <- data %>%"
"0","    select(where(is.factor))"
"0","  "
"0","  var_names <- colnames(categorical_vars)"
"0","  n <- length(var_names)"
"0","  "
"0","  correlation_matrix <- matrix(0, nrow = n, ncol = n, dimnames = list(var_names, var_names))"
"0","  "
"0","  for (i in 1:n) {"
"0","    for (j in 1:n) {"
"0","      if (i == j) {"
"0","        correlation_matrix[i, j] <- 1"
"0","      } else {"
"0","        contingency_table <- table(categorical_vars[[i]], categorical_vars[[j]])"
"0","        correlation_matrix[i, j] <- assocstats(contingency_table)$cramer"
"0","      }"
"0","    }"
"0","  }"
"0","  "
"0","  correlation_df <- as.data.frame(as.table(correlation_matrix)) %>%"
"0","    rename(Var1 = Var1, Var2 = Var2, value = Freq)"
"0",""
"0","  p <- ggplot(correlation_df, aes(Var1, Var2, fill = value)) +"
"0","    geom_tile() +"
"0","    geom_text(aes(label = round(value, 2)), color = ""black"", size = 4) + "
"0","    scale_fill_gradient2(low = ""blue"", mid = ""white"", high = ""red"", midpoint = 0.5, limits = c(0, 1)) +"
"0","    labs("
"0","      title = paste(""Correlação entre Variáveis Categóricas na Tabela"", table_name),"
"0","      x = NULL,"
"0","      y = NULL,"
"0","      fill = ""V de Cramer"""
"0","    ) +"
"0","    theme_minimal() +"
"0","    theme(axis.text.x = element_text(angle = 45, hjust = 1))"
"0","  "
"0","  print(p)"
"0","}"
