"0","create_barplot <- function(data, table_name) {"
"0","  categorical_vars <- data %>%"
"0","    select(where(is.factor)) %>%"
"0","    colnames()"
"0","  "
"0","  for (var in categorical_vars) {"
"0","    # Contar a frequência de cada categoria"
"0","    counts <- data %>%"
"0","      count(.data[[var]], name = ""frequency"")"
"0","    "
"0","    p <- ggplot(counts, aes(x = reorder(.data[[var]], -frequency), y = frequency)) +"
"0","      geom_bar(stat = ""identity"", fill = ""steelblue"") +"
"0","      geom_text(aes(label = frequency), size = 3, angle = 90) +"
"0","      labs("
"0","        title = paste(""Distribuição de"", var, ""na tabela"", table_name),"
"0","        x = var,"
"0","        y = ""Frequência"""
"0","      ) +"
"0","      theme_minimal() +"
"0","      theme(axis.text.x = element_text(angle = 90, hjust = 1))  # Rotaciona labels se houver muitas categorias"
"0","    "
"0","    print(p)"
"0","  }"
"0","}"
